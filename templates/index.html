<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <title>Driver Drowsiness Detection</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">


      <style>
        body {
            margin: 0;
            overflow-x: hidden;
        }
        nav {
            position: fixed;
            width: 100%;
            z-index: 30;
            padding: 20px 0;
        }
        #video {
            display: none;
        }

    </style>

</head>
<body>
    <!-- Navbar -->
    <nav class="bg-white text-black container mx-auto flex justify-around items-center h-16 w-screen rounded-b-lg">
         <div class="flex items-center h-full space-x-2 mx-8">
            <img src="{{ url_for('static', filename='images/logo.png') }}" class="h-8 w-auto object-contain">
            <img src="{{ url_for('static', filename='images/napnix.png') }}" class="h-8 w-auto object-contain">
        </div>
        <div class="space-x-8 mx-8">
            <a href="{{ url_for('index') }}" class="px-4 hover:text-gray-300 transition duration-300 font-medium text-xl">Home</a>
            <a href="#" class="px-4 hover:text-gray-300 transition duration-300 font-medium  text-xl">About</a>
            <a href="#" class="px-4 hover:text-gray-300 transition duration-300 font-medium  text-xl">Contact</a>

        </div>

        <div>
            <a href="{{ url_for('login') }}"> <button class="bg-transparent border-2 border-blue-600 text-white px-4 rounded-full text-lg font-semibold bg-blue-600 hover:bg-blue-600 hover:text-white transition duration-300">LogIn</button></a>
           <a href="{{ url_for('signup') }}"> <button class="bg-transparent border-2 border-blue-600 text-blue-600 px-4 rounded-full text-lg font-semibold hover:bg-blue-600 hover:text-white transition duration-300">SignUp</button></a>
        </div>

    </nav>


       <!-- Hero Section -->
    <div class="relative w-full h-screen">
        <img src="{{ url_for('static', filename='images/firstPage.jpg') }}" class="w-full h-full object-cover z-0">
        <div class="absolute inset-0 bg-blue-400 bg-opacity-60 flex flex-col items-center justify-center text-center z-20 text-white p-10 md:p-20 w-screen h-screen">
            <h1 class="text-4xl md:text-6xl font-bold mb-4 text-white">Alerting Vigilance ,Saving Lives</h1>
            <p class="text-lg md:text-2xl mb-8 text-white">Using advanced artificial intelligence, we help prevent accidents by detecting driver drowsiness in real-time and ensure the safety of all passengers on the road by continuously monitoring driver behavior.</p>
            <div class="flex space-x-4">
                <button id="startButton" class="bg-blue-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-blue-200 transition duration-300">Start Monitoring</button>
            </div>
        </div>

    </div>


    <div id="modal" class="hidden fixed inset-0 overflow-y-auto z-50">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <div class="fixed inset-0 bg-gray-900 opacity-75"></div>
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen lg:h-1/2" aria-hidden="true">&#8203;</span>
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
            <img id="modalImage" src="" alt="Modal Image" class="w-full">
            <button id="stopButton" class="bg-blue-600 text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-blue-200 transition duration-300">Stop</button>
        </div>
    </div>
</div>
    <!--<div>
        <button class="text-blue-600" >Start Drowsiness Detection</button>
    </div>
    <div>
        <img id="video" width="640" height="480">
    </div>-->
    <script>
        $(document).ready(function() {
            $('#startButton').click(function() {
                console.log("Button clicked."); // Check if the button click event is registered
                $.ajax({
                    type: "POST",
                    url: "/start_detection",
                    contentType: "application/json",
                    data: JSON.stringify({ start: "true" }), // Send JSON data with "start" key set to "true"
                    success: function(response) {
                        alert("Drowsiness detection started.");
                        //$('#video').attr('src', '/video_feed');
                        //$('#videoModal').removeClass('hidden'); // Show the modal
                        $('#modal').removeClass('hidden');
                          // Replace the src attribute with the path to your desired image
                        $('#modalImage').attr('src', '/video_feed');
                        $('#stopButton').click(function (){
                            console.log("stop")
                            $.ajax({
                                type: "POST",
                                url: "/start_detection",
                                contentType: "application/json",
                                data: JSON.stringify({ start: "false" }),
                                success: function(response) {
                                    alert("Drowsiness detection stoped.");
                                    $('#modal').addClass('hidden'); // Hide the modal
                                    location.reload();
                                }

                            })
                        })


                    },
                    error: function(xhr, status, error) {
                        console.error("Error starting drowsiness detection:", error);
                    }
                });
            });
            // Close modal when close button is clicked
            $(document).on('click', '#closeModal', function() {
              $('#videoModal').addClass('hidden'); // Hide the modal
    });
        });
    </script>
</body>
</html>
